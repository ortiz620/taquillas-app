# Requiere: Python + Flask
# Puedes usar esto directamente en Replit.com con la plantilla 'Flask'

from flask import Flask, render_template_string, request, redirect, url_for

app = Flask(__name__)

taquillas = []  # Lista para almacenar las taquillas

# HTML sencillo incrustado para la app
html = '''
<!DOCTYPE html>
<html>
<head>
    <title>Calculadora de Taquillas</title>
</head>
<body>
    <h1>Calculadora de Ventas por Taquilla</h1>

    <h2>Agregar nueva taquilla</h2>
    <form method="post" action="/agregar">
        Nombre: <input type="text" name="nombre" required><br>
        Precio por boleto: <input type="number" step="0.01" name="precio" required><br>
        <input type="submit" value="Agregar Taquilla">
    </form>

    <hr>

    <h2>Taquillas registradas</h2>
    {% for t in taquillas %}
        <form method="post" action="/calcular/{{ loop.index0 }}">
            <h3>{{ t['nombre'] }} (Precio: ${{ t['precio'] }})</h3>
            Boleto inicial: <input type="number" name="inicial" required>
            Boleto final: <input type="number" name="final" required>
            <input type="submit" value="Calcular Venta">
        </form>
        {% if t['resultado'] is not none %}
            <p><strong>Total de venta:</strong> ${{ t['resultado'] }}</p>
        {% endif %}
        <hr>
    {% endfor %}
</body>
</html>
'''

@app.route('/')
def index():
    return render_template_string(html, taquillas=taquillas)

@app.route('/agregar', methods=['POST'])
def agregar():
    nombre = request.form['nombre']
    precio = float(request.form['precio'])
    taquillas.append({
        'nombre': nombre,
        'precio': precio,
        'resultado': None
    })
    return redirect(url_for('index'))

@app.route('/calcular/<int:index>', methods=['POST'])
def calcular(index):
    inicial = int(request.form['inicial'])
    final = int(request.form['final'])
    boletos_vendidos = final - inicial - 2
    if boletos_vendidos < 0:
        boletos_vendidos = 0
    resultado = boletos_vendidos * taquillas[index]['precio']
    taquillas[index]['resultado'] = round(resultado, 2)
    return redirect(url_for('index'))

if __name__ == '__main__':
    app.run(debug=True)
